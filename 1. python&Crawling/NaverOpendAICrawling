import requests
from bs4 import BeautifulSoup
import openpyxl 
import json
import pprint
def write_excel_template(filename, sheetname, listdata):
    excel_file = openpyxl.Workbook()
    excel_sheet = excel_file.active
   
    if sheetname != '':
        excel_sheet.title = sheetname
    
    for item in listdata:
        excel_sheet.append(item)
    excel_file.save(filename)
    excel_file.close()

product_lists = list()

client_id='UYNqTmnGNnnLa4LWaTRV'
client_secret='6rM_8M0ii2'

start=1
num=0
for index in range(5):
    start_num=start+(index*100)
    naver_openapi='https://openapi.naver.com/v1/search/news.json?query=갤럭시24&display=100&start='+str(start_num)
    header_parame= {"X-Naver-Client-Id":client_id,"X-Naver-Client-Secret":client_secret}
    res=requests.get(naver_openapi,headers=header_parame)
    data=(res.json())
    for item in (data['items']):
        num+=1
        product_info=[num,item['title'],item['link']]
        product_lists.append(product_info)

write_excel_template('김지석.xlsx','프로젝트 상품',product_lists)